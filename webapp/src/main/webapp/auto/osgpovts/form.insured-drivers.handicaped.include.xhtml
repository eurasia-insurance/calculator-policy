<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:comp="http://xmlns.jcp.org/jsf/composite"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">

	<h:panelGrid columns="2">
		<p:selectBooleanCheckbox value="#{driver.handicaped}"
			widgetVar="w_isHandicapedCheckbox#{driver.safeId}">
			<p:ajax process="@this" update="privilegesPanel" />
		</p:selectBooleanCheckbox>
		<p:outputLabel value="#{gpovts['label.privileges.handicaped']}"
			onclick="PF('w_isHandicapedCheckbox#{driver.safeId}').toggle()" />
	</h:panelGrid>
	<p:panel rendered="#{driver.handicaped}">
		<p:outputLabel
			value="#{gpovts['label.privileges.handicaped-certificate.number']}" />
		<h:panelGrid columns="2">
			<p:inputText id="handicapedCertificateNumber"
				value="#{driver.handicapedCertificateData.number}">
				<p:ajax event="change" process="@this" update="privilegesPanel" />
			</p:inputText>
			<p:message for="handicapedCertificateNumber" />
		</h:panelGrid>
		<p:outputLabel
			value="#{gpovts['label.privileges.handicaped-certificate.valid-from']}" />
		<h:panelGrid columns="2">
			<p:calendar id="handicapedCertificateValidFrom"
				value="#{driver.handicapedCertificateData.validFrom}">
				<p:ajax event="change" process="@this" update="privilegesPanel" />
				<p:ajax event="dateSelect" process="@this" update="privilegesPanel" />
			</p:calendar>
			<p:message for="handicapedCertificateValidFrom" />
		</h:panelGrid>
		<p:outputLabel
			value="#{gpovts['label.privileges.handicaped-certificate.valid-till']}" />
		<h:panelGrid columns="2">
			<p:calendar id="handicapedCertificateValidTill"
				value="#{driver.handicapedCertificateData.validTill}">
				<p:ajax event="change" process="@this" update="privilegesPanel" />
				<p:ajax event="dateSelect" process="@this" update="privilegesPanel" />
			</p:calendar>
			<p:message for="handicapedCertificateValidTill" />
		</h:panelGrid>

		<p:outputLabel
			value="#{gpovts['label.privileges.handicaped-certificate.scan-files']}" />
		<p:panel id="handicapedCertificateGalleria" styleClass="ui-glr">
			<p:remoteCommand
				name="rc_NewHandicapedCertificateUploaded#{driver.safeId}"
				action="#{osgpovtsView.onHandicapedCertificateImageUploaded(driver)}"
				process="@this" update="@this, handicapedCertificateGalleria" />
			<ui:repeat var="image"
				value="#{driver.handicapedCertificateData.scanFiles}">
				<p:commandLink
					action="#{osgpovtsView.removeHandicapedCertificateImage(driver, image)}"
					ajax="true" process="@this"
					update="@this, @form(handicapedCertificateGalleria)">
					<p:graphicImage value="#{uploadedImageService.content}"
						styleClass="ui-glr-item ui-widget-content">
						<f:param name="id" value="#{image.id}" />
					</p:graphicImage>
				</p:commandLink>
			</ui:repeat>
			<p:fileUpload mode="advanced"
				label="#{glb['label.command.add-image']}"
				allowTypes="/(\.|\/)(gif|jpe?g|png)$/" multiple="true"
				sizeLimit="1000000" fileLimit="10" skinSimple="true" auto="true"
				fileUploadListener="#{uploadedImageService.onImageUpload}"
				oncomplete="rc_NewHandicapedCertificateUploaded#{driver.safeId}()">
			</p:fileUpload>
		</p:panel>
	</p:panel>

</ui:composition>